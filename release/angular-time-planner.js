!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("angularTimePlanner",[],n):"object"==typeof exports?exports.angularTimePlanner=n():e.angularTimePlanner=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=7)}([function(e,n,t){"use strict";e.exports={labels:{rowTitle:"Tasks",counterTitle:{days:"Days",hours:"Hours"}}}},function(e,n,t){"use strict";var r=t(9),a=function(e){return e&&e.__esModule?e:{default:e}}(r);angular.module("timePlannerCellDirective",[]).directive("timePlannerCell",["$rootScope",function(e){var n=["scope",function(n){n.onHoverEvent=function(e){n.$parent.highlightedItem=e},n.onClickEvent=function(n){return e.$broadcast("ATP_SEGMENT_ON_CLICK",n)}}];return{restrict:"A",template:a.default,link:n}}])},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}var o=t(10),i=r(o),s=t(8),l=r(s);t(6),angular.module("timePlannerContainerDirective",["ang-drag-drop"]).directive("timePlannerContainer",["$rootScope","$locale","LOCALES",function(e,n,r){return{restrict:"E",scope:{options:"=",rows:"="},controller:["$scope",function(o){function i(){o.options=(0,l.default)(f,o.options),o.locale=(0,l.default)(t(12)("./time-planner-locale_"+u),o.options.locale||{}),o.segments=s()}function s(){switch(o.options.timeScope){case"day":return d();case"range":break;case"week":default:return c()}}function d(){for(var e=[],n=0;n<24;n++)e.push(n);return e}function c(){var e=[].concat(a(n.DATETIME_FORMATS.SHORTDAY));return[].concat(a(e.splice(o.options.firstDay||0,e.length)),a(e))}var u=r.AVAILABLE.includes(n.id)?n.id:r.DEFAULT,f={timeScope:"week",needCounter:!1,editable:!1,dropChannel:"atp-row"};i(),o.$watchCollection("options",i),o.onDropEvent=function(n,t){return e.$broadcast("ATP_ITEM_ON_DROP",{id:t,item:n})}}],template:i.default}}])},function(e,n,t){"use strict";var r=t(11),a=function(e){return e&&e.__esModule?e:{default:e}}(r);angular.module("timePlannerRowDirective",[]).directive("timePlannerRow",function(){var e=["$scope",function(e){function n(){e.row.segments=[],e.row.hours=0,e.$parent.segments.forEach(function(){return e.row.segments.push([])}),e.row.items.forEach(o[e.$parent.options.timeScope].fillSegments)}function t(n){var t={scheduledStart:new Date(n.scheduled_start),scheduledEnd:new Date(n.scheduled_end)},r=void 0,o=void 0;t.scheduledStart.setHours(0,0,0,0),t.scheduledEnd.setHours(23,59,59,999),t=a(t),o=t.scheduledStart.getDay(),r=Math.ceil(Math.abs((t.scheduledStart.getTime()-t.scheduledEnd.getTime())/864e5)),e.row.hours+=8*r;for(var i=0;i<r;i++)e.row.segments[o+i].push(n)}function r(n){var t={scheduledStart:new Date(n.scheduled_start),scheduledEnd:new Date(n.scheduled_end)},r=void 0,o=void 0;t=a(t),o=t.scheduledStart.getHours(),r=t.scheduledEnd.getHours()-t.scheduledStart.getHours()+(0===t.scheduledEnd.getMinutes()?0:1),e.row.hours+=r;for(var i=0;i<r;i++)e.row.segments[o+i].push(n)}function a(n){return n.scheduledStart=n.scheduledStart<e.$parent.options.from?new Date(e.$parent.options.from):n.scheduledStart,n.scheduledEnd=n.scheduledEnd>e.$parent.options.to?new Date(e.$parent.options.to):n.scheduledEnd,n}var o={week:{fillSegments:t},day:{fillSegments:r}};n(),e.$watchCollection("options",n)}];return{restrict:"A",template:a.default,controller:e}})},function(e,n){},function(e,n){!function(e){"use strict";function n(e){e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),void 0!==e.dataTransfer&&"none"===e.dataTransfer.dropEffect&&("copy"===e.dataTransfer.effectAllowed||"move"===e.dataTransfer.effectAllowed?e.dataTransfer.dropEffect=e.dataTransfer.effectAllowed:"copyMove"!==e.dataTransfer.effectAllowed&&"copymove"!==e.dataTransfer.effectAllowed||(e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"))}if(!function(){return"ondrag"in document.createElement("a")}())return void e.module("ang-drag-drop",[]);var t=e.module("ang-drag-drop",[]);t.directive("uiDraggable",["$parse","$rootScope","$dragImage",function(t,r,a){return function(o,i,s){function l(e){e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),setTimeout(function(){i.unbind("$destroy",l)},0);var a=s.dragChannel||"defaultchannel";if(r.$broadcast("ANGULAR_DRAG_END",e,a),n(e),e.dataTransfer&&"none"!==e.dataTransfer.dropEffect){if(s.onDropSuccess){var d=t(s.onDropSuccess);o.$evalAsync(function(){d(o,{$event:e})})}}else if(e.dataTransfer&&"none"===e.dataTransfer.dropEffect&&s.onDropFailure){var c=t(s.onDropFailure);o.$evalAsync(function(){c(o,{$event:e})})}i.removeClass(g)}function d(n,r){var a;n.originalEvent&&(n.dataTransfer=n.originalEvent.dataTransfer),a=t(r),o.$apply(function(){var t,r=a(o,{$event:n});r&&e.isString(r)&&(t=document.getElementById(r))&&n.dataTransfer.setDragImage(t,0,0)})}function c(n){if(n.originalEvent&&(n.dataTransfer=n.originalEvent.dataTransfer),!p||f.classList.contains(u)){var c=s.dragChannel||"defaultchannel",v="";s.drag&&(v=o.$eval(s.drag));var m=s.dragImage||null;i.addClass(g),i.bind("$destroy",l);var h=!(document.uniqueID||window.opera);if(m&&h){var y=t(s.dragImage);o.$apply(function(){var t=y(o,{$event:n});if(t&&(e.isString(t)&&(t=a.generate(t)),t.image)){var r=t.xOffset||0,i=t.yOffset||0;n.dataTransfer.setDragImage(t.image,r,i)}})}else s.dragImageElementId&&d(n,s.dragImageElementId);var $={x:n.offsetX,y:n.offsetY},b={data:v,channel:c,offset:$},w=e.toJson(b);n.dataTransfer.setData("text",w),n.dataTransfer.effectAllowed="copyMove",r.$broadcast("ANGULAR_DRAG_START",n,c,b)}else n.preventDefault()}var u,f,p=!1,g=s.draggingClass||"on-dragging";i.attr("draggable",!1),o.$watch(s.uiDraggable,function(e){e?(i.attr("draggable",e),i.bind("dragend",l),i.bind("dragstart",c)):(i.removeAttr("draggable"),i.unbind("dragend",l),i.unbind("dragstart",c))}),e.isString(s.dragHandleClass)&&(p=!0,u=s.dragHandleClass.trim()||"drag-handle",i.bind("mousedown",function(e){f=e.target}))}}]),t.directive("uiOnDrop",["$parse","$rootScope",function(t,r){return function(a,o,i){function s(e){for(var n={x:e.offsetX,y:e.offsetY},t=e.target;t!==o[0];)if(n.x=n.x+t.offsetLeft,n.y=n.y+t.offsetTop,!(t=t.offsetParent))return null;return n}function l(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var n=t(i.uiOnDragOver);return a.$evalAsync(function(){n(a,{$event:e,$channel:v})}),!1}function d(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),0===--g&&(a.$evalAsync(function(){b(a,{$event:e,$channel:v})}),o.addClass(h),o.removeClass(y));var n=t(i.uiOnDragLeave);a.$evalAsync(function(){n(a,{$event:e,$channel:v})})}function c(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),0===g&&(a.$evalAsync(function(){$(a,{$event:e,$channel:v})}),o.removeClass(h),o.addClass(y)),g++;var n=t(i.uiOnDragEnter);a.$evalAsync(function(){n(a,{$event:e,$channel:v})}),r.$broadcast("ANGULAR_HOVER",m)}function u(r){r.originalEvent&&(r.dataTransfer=r.originalEvent.dataTransfer),r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation();var l=r.dataTransfer.getData("text");l=e.fromJson(l);var d=s(r),c=d?{x:d.x-l.offset.x,y:d.y-l.offset.y}:null;n(r);var u=t(i.uiOnDrop);a.$evalAsync(function(){u(a,{$data:l.data,$event:r,$channel:l.channel,$position:c})}),o.removeClass(h),g=0}function f(e,n){return"*"===n||new RegExp("(\\s|[,])+("+e+")(\\s|[,])+","i").test(","+n+",")}function p(e){return e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.dataTransfer.dropEffect="none",!1}var g=0,v=i.dropChannel||"defaultchannel",m="",h=i.dragEnterClass||"on-drag-enter",y=i.dragHoverClass||"on-drag-hover",$=t(i.onDragEnter),b=t(i.onDragLeave),w=r.$on("ANGULAR_DRAG_START",function(e,n,r,s){m=r;var g=!0;if(f(r,v)||(g=!1),g&&i.dropValidate){g=t(i.dropValidate)(a,{$drop:{scope:a,element:o},$event:n,$data:s.data,$channel:s.channel})}g?(o.bind("dragover",l),o.bind("dragenter",c),o.bind("dragleave",d),o.bind("drop",u),o.addClass(h)):(o.bind("dragover",p),o.bind("dragenter",p),o.bind("dragleave",p),o.bind("drop",p),o.removeClass(h))}),E=r.$on("ANGULAR_DRAG_END",function(){o.unbind("dragover",l),o.unbind("dragenter",c),o.unbind("dragleave",d),o.unbind("drop",u),o.removeClass(y),o.removeClass(h),o.unbind("dragover",p),o.unbind("dragenter",p),o.unbind("dragleave",p),o.unbind("drop",p)});a.$on("$destroy",function(){w(),E()}),i.$observe("dropChannel",function(e){e&&(v=e)})}}]),t.constant("$dragImageConfig",{height:20,width:200,padding:10,font:"bold 11px Arial",fontColor:"#eee8d5",backgroundColor:"#93a1a1",xOffset:0,yOffset:0}),t.service("$dragImage",["$dragImageConfig",function(n){function t(e,n,t){var a=e.measureText(n).width;if(a<t.width)return n;for(;a+t.padding>t.width;)n=n.substring(0,n.length-1),a=e.measureText(n+r).width;return n+r}var r="â€¦";this.generate=function(r,a){var o=e.extend({},n,a||{}),i=document.createElement("canvas");i.height=o.height,i.width=o.width;var s=i.getContext("2d");s.fillStyle=o.backgroundColor,s.fillRect(0,0,o.width,o.height),s.font=o.font,s.fillStyle=o.fontColor;var l=t(s,r,o);s.fillText(l,4,o.padding+4);var d=new Image;return d.src=i.toDataURL(),{image:d,xOffset:o.xOffset,yOffset:o.yOffset}}}])}(angular)},function(e,n,t){t(5),e.exports="ang-drag-drop"},function(e,n,t){"use strict";t(2),t(3),t(1),t(4),angular.module("angularTimePlanner",["timePlannerContainerDirective","timePlannerRowDirective","timePlannerCellDirective"]).constant("LOCALES",{DEFAULT:"en-us",AVAILABLE:["en-us"]})},function(e,n,t){"use strict";function r(e){return!!e&&"object"==typeof e}function a(e){var n=Object.prototype.toString.call(e);return"[object RegExp]"===n||"[object Date]"===n||o(e)}function o(e){return e.$$typeof===p}function i(e){return Array.isArray(e)?[]:{}}function s(e,n){return n&&!0===n.clone&&u(e)?c(i(e),e,n):e}function l(e,n,t){var r=e.slice();return n.forEach(function(n,a){void 0===r[a]?r[a]=s(n,t):u(n)?r[a]=c(e[a],n,t):-1===e.indexOf(n)&&r.push(s(n,t))}),r}function d(e,n,t){var r={};return u(e)&&Object.keys(e).forEach(function(n){r[n]=s(e[n],t)}),Object.keys(n).forEach(function(a){u(n[a])&&e[a]?r[a]=c(e[a],n[a],t):r[a]=s(n[a],t)}),r}function c(e,n,t){var r=Array.isArray(n),a=Array.isArray(e),o=t||{arrayMerge:l};if(r===a)return r?(o.arrayMerge||l)(e,n,t):d(e,n,t);return s(n,t)}var u=function(e){return r(e)&&!a(e)},f="function"==typeof Symbol&&Symbol.for,p=f?Symbol.for("react.element"):60103;c.all=function(e,n){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,t){return c(e,t,n)})};var g=c;e.exports=g},function(e,n){e.exports='<div class=atp-segment-item-wrapper><div class=atp-segment-item ng-repeat="item in segment" ng-class="[item.segmentType, {\'highlighted\': (item.id === highlightedItem.id)}]" ng-mouseenter=onHoverEvent(item) ng-mouseleave=onHoverEvent() ng-click=onClickEvent(item)></div></div>'},function(e,n){e.exports='<div class=atp-container><div class=atp-head><div class=atp-row><div class="atp-cell atpr-title"><span class=atpc-label>{{locale.labels.rowTitle}}</span></div><div class="atp-cell atpr-counter" ng-if=options.needCounter><span class=atpc-label>{{locale.labels.counterTitle.hours}}</span></div><div class="atp-cell atp-segment" ng-repeat="segment in segments" ng-class="{\'week-day-segment\': options.timeScope === \'week\',\n                      \'hour-segment\': options.timeScope === \'day\'}"><span class=atpc-label>{{segment}}</span></div></div></div><div class=atp-row ng-repeat="row in rows" drop-channel="{{options.editable && row.editable && options.dropChannel}}" ui-on-drop="onDropEvent($data, row.id)" time-planner-row></div></div>'},function(e,n){e.exports='<div class="atp-cell atpr-title"><span class=atpc-label>{{row.title}}</span></div><div class="atp-cell atpr-counter" ng-if=options.needCounter><span class=atpc-label>{{row.hours || 0}}</span></div><div class="atp-cell atp-segment" ng-repeat="segment in row.segments" ng-class="{\'week-day-segment\': options.timeScope === \'week\',\n                \'hour-segment\': options.timeScope === \'day\'}" time-planner-cell></div>'},function(e,n,t){function r(e){return t(a(e))}function a(e){var n=o[e];if(!(n+1))throw new Error("Cannot find module '"+e+"'.");return n}var o={"./time-planner-locale_en-us":0,"./time-planner-locale_en-us.js":0};r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id=12}])});
//# sourceMappingURL=angular-time-planner.js.map